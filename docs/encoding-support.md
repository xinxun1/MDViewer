# 编码支持说明

MD Viewer 现在支持多种文件编码，特别是中文编码格式。

## 🌐 支持的编码

### 自动检测（推荐）

MD Viewer 会自动检测以下编码：

- **UTF-8** - 国际标准编码，推荐使用
- **GBK** - 中文 Windows 系统常用编码
- **GB2312** - 简体中文编码
- **GB18030** - 中国国家标准编码
- **Big5** - 繁体中文编码
- **UTF-16 LE/BE** - Unicode 16位编码

### 检测原理

1. **BOM 检测** - 优先检测文件开头的 BOM（字节顺序标记）
   - UTF-8 BOM: `EF BB BF`
   - UTF-16 LE BOM: `FF FE`
   - UTF-16 BE BOM: `FE FF`

2. **内容分析** - 如果没有 BOM，分析文件内容
   - 尝试 UTF-8 解码
   - 失败则判定为 GBK/GB2312

## 🔧 使用方法

### 自动检测（默认）

1. 打开文件时，系统会自动检测编码
2. 如果检测到非 UTF-8 编码，会显示提示信息
3. 大多数情况下自动检测可以正确识别

### 手动选择编码

如果自动检测失败或显示乱码：

1. 在工具栏右侧找到编码下拉框
2. 选择正确的编码格式
3. 文件会自动重新加载

**可选编码：**
- 自动检测（默认）
- UTF-8
- GBK
- GB2312
- GB18030
- Big5
- UTF-16 LE
- UTF-16 BE

## 📝 常见问题

### Q: 文件显示乱码怎么办？

**A:** 尝试以下步骤：
1. 手动选择 GBK 编码（最常见的中文编码）
2. 如果还是乱码，尝试 GB2312 或 GB18030
3. 繁体中文可能需要 Big5 编码

### Q: 为什么会出现编码问题？

**A:** 
- Windows 记事本默认使用 ANSI（通常是 GBK）编码
- 某些旧系统或软件使用 GB2312
- 不同操作系统默认编码不同

### Q: 如何避免编码问题？

**A:** 建议：
1. **新文件使用 UTF-8 编码**
2. 使用现代编辑器（VS Code、Sublime Text 等）
3. 保存时选择 UTF-8 编码
4. 尽量添加 UTF-8 BOM（可选）

### Q: 保存时会使用什么编码？

**A:** 
- 保存时会使用 UTF-8 编码
- 这是现代标准，兼容性最好
- 建议所有新文件都使用 UTF-8

## 📋 编码对照表

| 编码 | 说明 | 适用场景 |
|------|------|----------|
| UTF-8 | 国际标准 | ✅ 推荐使用，兼容性最好 |
| GBK | 中文 Windows | Windows 记事本默认编码 |
| GB2312 | 简体中文 | 旧系统中文编码 |
| GB18030 | 中国标准 | 最完整的中文编码 |
| Big5 | 繁体中文 | 港澳台地区常用 |
| UTF-16 | Unicode | Office 文档等使用 |

## 🛠️ 技术细节

### 编码检测流程

```
打开文件
    ↓
检查用户是否手动选择编码？
    ↓ 是
使用指定编码解码
    ↓ 否
检测 BOM
    ↓ 有 BOM
使用 BOM 指定的编码
    ↓ 无 BOM
尝试 UTF-8 解码
    ↓ 成功
使用 UTF-8
    ↓ 失败
尝试 GBK 及其他编码
    ↓
显示内容
```

### 为什么支持 GBK 重要？

1. **历史遗留** - 大量中文文档使用 GBK 编码
2. **Windows 默认** - Windows 记事本默认保存为 GBK
3. **兼容性** - 需要支持旧文档的查看和编辑

## 💡 最佳实践

### 创建新文档

```markdown
1. 使用现代编辑器（VS Code、Sublime Text）
2. 设置默认编码为 UTF-8
3. 启用自动保存 BOM（可选）
```

### 转换旧文档

如果你有大量 GBK 编码的文档，建议：

1. 使用 MD Viewer 打开
2. 确认内容正确显示
3. 编辑并保存（会自动转为 UTF-8）

### 团队协作

- 统一使用 UTF-8 编码
- 在 `.editorconfig` 中指定编码
- Git 中设置 `*.md text eol=lf encoding=utf-8`

## 🔍 调试技巧

### 查看文件编码

在 VS Code 中：
1. 打开文件
2. 查看右下角状态栏
3. 点击编码标签可更改

### 使用命令行

Windows:
```powershell
[System.Text.Encoding]::Default.EncodingName
```

Linux/Mac:
```bash
file -bi filename.md
```

## 📚 相关资源

- [Unicode 标准](https://unicode.org/)
- [字符编码详解](https://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html)
- [GBK 编码表](https://www.qqxiuzi.cn/zh/hanzi-gbk-bianma.php)

---

**提示：** 如果遇到编码问题，请尝试手动选择编码，或联系我们反馈。
