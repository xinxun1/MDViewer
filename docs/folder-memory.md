# æ–‡ä»¶å¤¹è®°å¿†åŠŸèƒ½

## åŠŸèƒ½ä»‹ç»

MD Viewer ç°åœ¨æ”¯æŒ**è‡ªåŠ¨è®°ä½ä¸Šæ¬¡æ‰“å¼€çš„æ–‡ä»¶å¤¹**ï¼Œä¸‹æ¬¡æ‰“å¼€åº”ç”¨æ—¶æ— éœ€é‡æ–°é€‰æ‹©ï¼Œæå¤§æå‡ä½¿ç”¨ä½“éªŒï¼

## å·¥ä½œåŸç†

### æŠ€æœ¯å®ç°

1. **IndexedDB å­˜å‚¨** - ä½¿ç”¨æµè§ˆå™¨çš„ IndexedDB æ•°æ®åº“å­˜å‚¨æ–‡ä»¶å¤¹å¥æŸ„
2. **æƒé™ç®¡ç†** - è‡ªåŠ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™
3. **æ™ºèƒ½æ¢å¤** - é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨å°è¯•æ¢å¤ä¸Šæ¬¡çš„æ–‡ä»¶å¤¹

### æƒé™æœºåˆ¶

æµè§ˆå™¨çš„ File System Access API æä¾›ä¸‰ç§æƒé™çŠ¶æ€ï¼š

- **granted** - å·²æˆæƒï¼Œå¯ä»¥ç›´æ¥è®¿é—®
- **prompt** - éœ€è¦ç”¨æˆ·ç¡®è®¤ï¼Œä¼šå¼¹å‡ºæƒé™è¯·æ±‚
- **denied** - å·²æ‹’ç»ï¼Œéœ€è¦ç”¨æˆ·é‡æ–°æ‰“å¼€æ–‡ä»¶å¤¹

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯ä¸€ï¼šé¦–æ¬¡æ‰“å¼€æ–‡ä»¶å¤¹

```
1. ç”¨æˆ·ç‚¹å‡»"æ‰“å¼€æ–‡ä»¶å¤¹"æŒ‰é’®
2. é€‰æ‹©æ–‡ä»¶å¤¹ï¼ˆä¾‹å¦‚ï¼šD:/Documents/Notesï¼‰
3. ç³»ç»Ÿè‡ªåŠ¨ä¿å­˜è¿™ä¸ªæ–‡ä»¶å¤¹çš„è®¿é—®æƒé™
4. å¼€å§‹æµè§ˆå’Œç¼–è¾‘ Markdown æ–‡ä»¶
```

### åœºæ™¯äºŒï¼šä¸‹æ¬¡æ‰“å¼€åº”ç”¨

```
1. ç”¨æˆ·æ‰“å¼€ standalone.html
2. ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹åˆ°ä¸Šæ¬¡çš„æ–‡ä»¶å¤¹
3. å¦‚æœæœ‰è®¿é—®æƒé™ï¼Œç›´æ¥åŠ è½½æ–‡ä»¶åˆ—è¡¨
4. å¦‚æœéœ€è¦æƒé™ï¼Œä¼šå¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†
5. ç”¨æˆ·ç¡®è®¤åï¼Œç«‹å³æ¢å¤ä¹‹å‰çš„å·¥ä½œçŠ¶æ€
```

### åœºæ™¯ä¸‰ï¼šæƒé™è¿‡æœŸ

```
å¦‚æœæµè§ˆå™¨æ¸…é™¤äº†æƒé™æˆ–ç”¨æˆ·æ‹’ç»è®¿é—®ï¼š
1. ç³»ç»Ÿä¼šæç¤º"ä¸Šæ¬¡çš„æ–‡ä»¶å¤¹éœ€è¦é‡æ–°æˆæƒ"
2. ç”¨æˆ·ç‚¹å‡»"æ‰“å¼€æ–‡ä»¶å¤¹"é‡æ–°é€‰æ‹©
3. æ–°çš„æ–‡ä»¶å¤¹ä¼šæ›¿ä»£ä¹‹å‰çš„è®°å½•
```

## å®é™…æ•ˆæœ

### âœ… æœ‰æƒé™çš„æƒ…å†µ

```
ğŸ‰ å·²è‡ªåŠ¨æ‰“å¼€ä¸Šæ¬¡çš„æ–‡ä»¶å¤¹: Notes
ğŸ“‚ åŠ è½½æ–‡ä»¶åˆ—è¡¨...
âœ“ æ‰¾åˆ° 25 ä¸ª Markdown æ–‡ä»¶
```

### ğŸ”’ éœ€è¦æˆæƒçš„æƒ…å†µ

æµè§ˆå™¨ä¼šå¼¹å‡ºæƒé™ç¡®è®¤å¯¹è¯æ¡†ï¼š

```
[æµè§ˆå™¨æç¤ºæ¡†]
standalone.html æƒ³è¦æŸ¥çœ‹ "Notes" æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶
[å…è®¸] [æ‹’ç»]
```

ç‚¹å‡»"å…è®¸"åï¼š
```
âœ… å·²æ¢å¤ä¸Šæ¬¡çš„æ–‡ä»¶å¤¹: Notes
ğŸ“‚ åŠ è½½æ–‡ä»¶åˆ—è¡¨...
```

### âŒ æ²¡æœ‰æƒé™çš„æƒ…å†µ

```
â„¹ï¸ ç‚¹å‡»"æ‰“å¼€æ–‡ä»¶å¤¹"å¼€å§‹
ğŸ’¡ ä¸Šæ¬¡çš„æ–‡ä»¶å¤¹éœ€è¦é‡æ–°æˆæƒ
```

## æ•°æ®å­˜å‚¨

### å­˜å‚¨ä½ç½®

æ•°æ®ä¿å­˜åœ¨æµè§ˆå™¨çš„ IndexedDB ä¸­ï¼š

- **æ•°æ®åº“åç§°**: `md-viewer-db`
- **å­˜å‚¨ç©ºé—´**: `folders`
- **é”®å**: `lastFolder`
- **å€¼**: æ–‡ä»¶å¤¹å¥æŸ„å¯¹è±¡

### æ•°æ®å®‰å…¨

- âœ… **æœ¬åœ°å­˜å‚¨** - æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­
- âœ… **ä¸ä¸Šä¼ äº‘ç«¯** - æ–‡ä»¶å¤¹ä¿¡æ¯ä¸ä¼šå‘é€åˆ°ä»»ä½•æœåŠ¡å™¨
- âœ… **éšç§ä¿æŠ¤** - åªå­˜å‚¨æ–‡ä»¶å¤¹è®¿é—®æƒé™ï¼Œä¸è¯»å–æ–‡ä»¶å†…å®¹
- âœ… **å¯æ¸…é™¤** - å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¾ç½®æ¸…é™¤æ‰€æœ‰æ•°æ®

### æ¸…é™¤æ•°æ®

å¦‚æœéœ€è¦æ¸…é™¤ä¿å­˜çš„æ–‡ä»¶å¤¹è®°å½•ï¼š

#### æ–¹æ³•ä¸€ï¼šæµè§ˆå™¨è®¾ç½®

1. Chrome/Edge: æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
2. åˆ‡æ¢åˆ° `Application` æ ‡ç­¾
3. å·¦ä¾§æ‰¾åˆ° `Storage` â†’ `IndexedDB` â†’ `md-viewer-db`
4. å³é”®ç‚¹å‡»æ•°æ®åº“ï¼Œé€‰æ‹© `Delete database`

#### æ–¹æ³•äºŒï¼šæ¸…é™¤æµè§ˆå™¨æ•°æ®

1. Chrome/Edge: `è®¾ç½®` â†’ `éšç§å’Œå®‰å…¨` â†’ `æ¸…é™¤æµè§ˆæ•°æ®`
2. é€‰æ‹© `Cookie å’Œå…¶ä»–ç½‘ç«™æ•°æ®`
3. é€‰æ‹©æ—¶é—´èŒƒå›´ï¼Œç‚¹å‡» `æ¸…é™¤æ•°æ®`

## æµè§ˆå™¨å…¼å®¹æ€§

### âœ… å®Œå…¨æ”¯æŒ

- Chrome 86+
- Edge 86+
- Opera 72+

### âš ï¸ éƒ¨åˆ†æ”¯æŒ

- Firefoxï¼ˆéœ€è¦å¯ç”¨å®éªŒæ€§åŠŸèƒ½ï¼‰
- Safariï¼ˆéœ€è¦å¯ç”¨å®éªŒæ€§åŠŸèƒ½ï¼‰

### âŒ ä¸æ”¯æŒ

- IE 11 åŠæ›´æ—©ç‰ˆæœ¬
- æ—§ç‰ˆç§»åŠ¨æµè§ˆå™¨

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæœ‰æ—¶éœ€è¦é‡æ–°æˆæƒï¼Ÿ

**A**: æµè§ˆå™¨å¯èƒ½åœ¨ä»¥ä¸‹æƒ…å†µæ¸…é™¤æƒé™ï¼š
- æ¸…é™¤æµè§ˆå™¨æ•°æ®/Cookie
- éšç§æ¨¡å¼/æ— ç—•æ¨¡å¼
- æµè§ˆå™¨ç‰ˆæœ¬æ›´æ–°
- ç³»ç»Ÿé‡å¯åä¸€æ®µæ—¶é—´

### Q: å¯ä»¥è®°ä½å¤šä¸ªæ–‡ä»¶å¤¹å—ï¼Ÿ

**A**: å½“å‰ç‰ˆæœ¬åªè®°ä½æœ€åä¸€æ¬¡æ‰“å¼€çš„æ–‡ä»¶å¤¹ã€‚å¦‚æœæ‰“å¼€æ–°æ–‡ä»¶å¤¹ï¼Œä¼šè¦†ç›–ä¹‹å‰çš„è®°å½•ã€‚

### Q: è¿™ä¸ªåŠŸèƒ½å®‰å…¨å—ï¼Ÿ

**A**: éå¸¸å®‰å…¨ï¼
- åªå­˜å‚¨æ–‡ä»¶å¤¹çš„è®¿é—®æƒé™å¥æŸ„
- ä¸è¯»å–æˆ–ä¸Šä¼ ä»»ä½•æ–‡ä»¶å†…å®¹
- æ‰€æœ‰æ•°æ®éƒ½åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­
- å®Œå…¨éµå®ˆæµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥

### Q: ä¼šå½±å“æ€§èƒ½å—ï¼Ÿ

**A**: å‡ ä¹æ²¡æœ‰å½±å“ï¼š
- åˆå§‹åŒ– IndexedDB åªéœ€å‡ æ¯«ç§’
- æ¢å¤æ–‡ä»¶å¤¹æ˜¯å¼‚æ­¥æ“ä½œï¼Œä¸é˜»å¡ç•Œé¢
- åªåœ¨åº”ç”¨å¯åŠ¨æ—¶æ‰§è¡Œä¸€æ¬¡

### Q: éšç§æ¨¡å¼ä¸‹èƒ½ç”¨å—ï¼Ÿ

**A**: å¯ä»¥ç”¨ï¼Œä½†æœ‰é™åˆ¶ï¼š
- éšç§æ¨¡å¼ä¸‹å¯ä»¥æ­£å¸¸æ‰“å¼€æ–‡ä»¶å¤¹
- ä½†å…³é—­æµè§ˆå™¨åï¼Œè®°å½•ä¼šè¢«æ¸…é™¤
- ä¸‹æ¬¡æ‰“å¼€éœ€è¦é‡æ–°é€‰æ‹©æ–‡ä»¶å¤¹

## å¼€å‘è€…ä¿¡æ¯

### æ ¸å¿ƒ API

```javascript
// åˆå§‹åŒ–æ•°æ®åº“
async initDB() {
    return new Promise((resolve, reject) => {
        const request = indexedDB.open('md-viewer-db', 1);
        request.onsuccess = () => {
            this.db = request.result;
            resolve();
        };
    });
}

// ä¿å­˜æ–‡ä»¶å¤¹å¥æŸ„
async saveFolderHandle(handle) {
    const transaction = this.db.transaction(['folders'], 'readwrite');
    const store = transaction.objectStore('folders');
    await store.put(handle, 'lastFolder');
}

// æ¢å¤æ–‡ä»¶å¤¹
async restoreLastFolder() {
    const transaction = this.db.transaction(['folders'], 'readonly');
    const store = transaction.objectStore('folders');
    const handle = await store.get('lastFolder');
    
    if (handle) {
        const permission = await handle.queryPermission({ mode: 'read' });
        if (permission === 'granted') {
            this.directoryHandle = handle;
            await this.loadFiles();
        }
    }
}
```

### æ‰©å±•å»ºè®®

æœªæ¥å¯ä»¥è€ƒè™‘çš„æ”¹è¿›ï¼š

- [ ] æ”¯æŒè®°ä½å¤šä¸ªå¸¸ç”¨æ–‡ä»¶å¤¹ï¼ˆæœ€è¿‘è®¿é—®åˆ—è¡¨ï¼‰
- [ ] æ”¯æŒä¸ºæ–‡ä»¶å¤¹æ·»åŠ ä¹¦ç­¾/æ ‡ç­¾
- [ ] æ”¯æŒè®°ä½æ¯ä¸ªæ–‡ä»¶å¤¹çš„æœ€åæ‰“å¼€çš„æ–‡ä»¶
- [ ] æ”¯æŒæ–‡ä»¶å¤¹åˆ‡æ¢å†å²è®°å½•
- [ ] æ”¯æŒå¯¼å‡º/å¯¼å…¥æ–‡ä»¶å¤¹åˆ—è¡¨

## æ€»ç»“

æ–‡ä»¶å¤¹è®°å¿†åŠŸèƒ½è®© MD Viewer çš„ä½¿ç”¨æ›´åŠ ä¾¿æ·ï¼š

âœ… **ä¸€æ¬¡é€‰æ‹©ï¼Œé•¿æœŸä½¿ç”¨** - æ— éœ€æ¯æ¬¡éƒ½é‡æ–°é€‰æ‹©æ–‡ä»¶å¤¹  
âœ… **æ™ºèƒ½æƒé™ç®¡ç†** - è‡ªåŠ¨å¤„ç†æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™  
âœ… **ç”¨æˆ·ä½“éªŒä¼˜å…ˆ** - å‡å°‘é‡å¤æ“ä½œï¼Œæå‡å·¥ä½œæ•ˆç‡  
âœ… **éšç§å®‰å…¨** - æ‰€æœ‰æ•°æ®æœ¬åœ°å­˜å‚¨ï¼Œä¸ä¸Šä¼ äº‘ç«¯  

äº«å—æ›´åŠ æµç•…çš„ Markdown ç¼–è¾‘ä½“éªŒå§ï¼ğŸ‰
